# spring bean
> Spring Framework의 Container에 의해 등록/생성/조회/관계 설정되는 객체로 일반적인 Java Object임.

## Inversion Of Control / Dependency Injection
> 의존관계 처리 방식으로서, 해석하자면 "역전제어"와 "의존성 주입"
> 의역하자면 의존성을 명시적으로 즉, User user = new User(); 코드로 관계 설정을 하는 것이 아니라,
> Spring Container에 의해 처리하도록 xml 또는 annotation으로 선언하는 것을 말합니다.
> Springboot에서는 annotation을 활용하는 것이 일반적임.

### 예시
> Bean 선언
  ```java
  interface Ball {
    String touchBall();
  }

  @Component("soccerBall")
  public class SoccerBall implements Ball{
    public String touchBall(){
      return "축구공이 굴러간다";
    }
  }

  @Component("basketBall")
  public class BasketBall implements Ball{
    public String touchBall(){
      return "농구공이 굴러간다";
    }
  }
  ```
> Bean 사용
  ``` Java
  @Component
  public class Player {
    @Autowired
    @Qualifier("soccerBall")
    private Ball ballA;
    @Autowired
    @Qualifier("basketBall")
    private Ball ballB;

    public String touch(){
      this.ballA.touchBall();
      this.ballB.touchBall();
    }
  }
  ```
## Spring Bean Instance/Memory 유형
> bean은 기본적으로 Spring Container에 1개의 인스턴스만 존재함. @Scope를 통해
> 다양한 방식을 지정할 수 있음
> Bean 선언 뒤에 @Scope("..")로 지정할 수 있음
> 주) 기본적으로 Singleton구조로 객체의 데이터는 request별로 공유되어 조심해야함  
> 특히, 사용자 정보 등을 멤버 변수에 보관하게 되면 request 별로 정보가 섞여서 처리될 수 있음

1. @Scope("singleton"): 기본(Default) 싱글톤 스코프. 하나의 Bean 정의에 대해서 Container 내에 단 하나의 객체만 존재한다.
2. @Scope("prototype") : 어플리케이션에서 요청시 (getBean()) 마다 스프링이 새 인스턴스를 생성
3. @Scope("request"):HTTP 요청별로 인스턴스화 되며 요청이 끝나면 소멸 (spring mvc webapplication 용도)
4. @Scope("session"):HTTP 세션별로 인스턴스화되며 세션이 끝나며 소멸 (spring mvc webapplication 용도)
5. @Scope("application"): webapp/springboot에서는 singleton과 동일한 기능으로 동작

```tips
stateless한 restful api에서는 singleton타입이 유효함.
```

## Spring Bean Lifecycle
Bean 객체는 생성시 생성자 > @PostConstruct 순서로 실행되며, 소멸시에는 @PreDestroy 가 호출된다.

``` java
@Component("soccerBall")
public class SoccerBall implements Ball {
  public SoccerBall() {
    System.out.println("soccerBall created by constructor");
  }

  public String touchBall() {
    return "축구공이 굴러간다";
  }

  @PostConstruct
  public void init() {
    System.out.println("socckerball init");
  }

  @PreDestroy
  public void close() {
    System.out.println("socckerball destroy");
  }
}
```

## Spring Bean 선언 및 종류(Annotation)
> Bean은 기본적으로 Bean 생성자 함수 또는 클래스에 Annotation을 지정하여 Bean을 선언함



## Spring Bean 사용방법

### Bean 이름